SELECT GDH_BASEDOCUMENTNO,GDH_DOC_REFERENCE_NO,PLC_LOCADESC,dh.PPS_PARTY_CODE,PPS_DESC,PDP_DEPTDESC,PBC_DESC,GDH_ISSUEDATE,GDH_EXPIRYDATE,GDH_TOTALSI,GDH_GROSSPREMIUM,GDH_NETPREMIUM,bd.*,VCHDATE,KNOCKOFFAMOUNT,PVT_VCHTTYPE,PFS_ACNTYEAR,LVH_VCHDNO 
FROM GI_GU_BD_BANKDTL BD
left outer join GI_GU_DH_DOC_HEADER dh
on (
bd.POR_ORG_CODE||bd.PLC_LOC_CODE||bd.PDP_DEPT_CODE||bd.PBC_BUSICLASS_CODE||bd.PIY_INSUTYPE||bd.GDH_DOCUMENTNO||bd.GDH_RECORD_TYPE||bd.PDT_DOCTYPE||bd.GDH_YEAR=
dh.POR_ORG_CODE||dh.PLC_LOC_CODE||dh.PDP_DEPT_CODE||dh.PBC_BUSICLASS_CODE||dh.PIY_INSUTYPE||dh.GDH_DOCUMENTNO||dh.GDH_RECORD_TYPE||dh.PDT_DOCTYPE||dh.GDH_YEAR
) 
left outer join COLLECTION_TABLE ct 
on ( GDH_DOC_REFERENCE_NO=docref
)
left outer join PR_GN_LC_LOCATION lc
on (dh.PLC_LOC_CODE=lc.PLC_LOCaCODE

)
left outer join PR_GN_PS_PARTY pp
on (
dh.PPS_PARTY_CODE=pp.PPS_PARTY_CODE
)
left outer join (select distinct PDP_DEPTCODE,PDP_DEPTDESC from PR_GN_DP_DEPARTMENT) dd
on (dd.PDP_DEPTCODE=dh.PDP_DEPT_CODE)

left outer join PR_GG_BC_BUSINESS_CLASS bc
on (
dh.PBC_BUSICLASS_CODE=bc.PBC_BUSICLASS_CODE and dd.PDP_DEPTCODE=bc.PDP_DEPT_CODE
)


WHERE bd.GDH_YEAR=2018 and GDH_ISSUEDATE between '01-apr-2018' and '30-sep-2018' AND bd.GDH_RECORD_TYPE='O'
AND EXISTS 
(
SELECT 
'X' FROM HIL.PR_GN_BN_BANK B
Where
PBN_BNK_DESC LIKE '%Nation%'
 AND PBN_TYPE = 'D' AND BD.PBN_BNK_CODE=B.PBN_BNK_CODE
 );
